{
  "hash": "2e719eb5bca7e38e55a399287e901d0b",
  "result": {
    "markdown": "---\ntitle: \"Clustering\"\nauthor: \"Heba Nusair\"\ndate: \"2023-11-03\"\ncategories: [news, code, plot]\n---\n\nSince this post doesn't specify an explicit `image`, the first image in the post will be used in the listing page of posts.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nfrom sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\n\n# Load the data\ndf = pd.read_csv('xy2.csv')\n\n# Assuming you're using 3 clusters (adjust as necessary)\nkmeans = KMeans(n_clusters=3, random_state=0)\nkmeans.fit(df[['X', 'Y']])\n\n# Assign the cluster labels to the DataFrame\ndf['Cluster'] = kmeans.labels_\n\n# Plotting the clusters\nplt.scatter(df['X'], df['Y'], c=df['Cluster'], cmap='viridis')\nplt.title('K-Means Clustering of Home Locations')\nplt.xlabel('X (Longitude)')\nplt.ylabel('Y (Latitude)')\nplt.colorbar(label='Cluster Label')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-1.png){width=595 height=449}\n:::\n:::\n\n\n\\\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.compose import ColumnTransformer\nimport matplotlib.pyplot as plt\n\n# Load the data\ndf = pd.read_csv('Homeplaces in Roanoke and Salem Cities.csv')\n\n# Convert categorical data to numerical\ndf['Employee_t'] = df['Employee_t'].astype('category').cat.codes\n\n# Standardizing the features (important for K-Means)\nct = ColumnTransformer([\n    (\"norm1\", StandardScaler(), ['X', 'Y']),\n    (\"norm2\", StandardScaler(), ['Employee_t'])\n], remainder='passthrough')\n\ndf_scaled = ct.fit_transform(df)\n\n# KMeans clustering\nkmeans = KMeans(n_clusters=5, n_init=10)\nclusters = kmeans.fit_predict(df_scaled)\n\n# Adding cluster labels to your dataframe\ndf['Cluster'] = clusters\n\n# Plotting the clusters\nplt.figure(figsize=(10, 6))\ncolors = ['red', 'green', 'blue', 'purple', 'orange']\nfor i in range(kmeans.n_clusters):\n    plt.scatter(df[df['Cluster'] == i]['X'], df[df['Cluster'] == i]['Y'], \n                color=colors[i], label=f'Cluster {i}')\n\nplt.title('Homeplaces Clustering in Roanoke and Salem Cities')\nplt.xlabel('Longitude')\nplt.ylabel('Latitude')\nplt.legend()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=838 height=523}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}