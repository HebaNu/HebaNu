{
  "hash": "4a741e343ec03c809c6dbe20c7b9bfcf",
  "result": {
    "markdown": "---\ntitle: \"Exploring the Relationship Between Income and Living Location Preference\"\nsubtitle: \"A Comparative Analysis of Linear and Non-Linear Regression Models\"\nauthor: \"Heba Nusair\"\ndate: \"2023-11-06\"\ncategories: [news, code, analysis]\nimage: \"Urban_NonUrban_Rural.jpg\"\n---\n\n### **Introduction**\n\nIn an effort to understand how income influences living location preferences among Workers From Home (WFH), we embarked on a comprehensive analysis using linear regression. This statistical method helps in identifying the relationship between two variables -- in this case, income and the preferred living areas of WFH workers within the metropolitan areas: City_center, Urban_area, Suburban_area, or Rural_area (See the figure).\n\n![The urban areas classification in Roanoke Metropolitan Area produced by the author.](Urban_NonUrban_Rural.jpg){fig-align=\"center\" width=\"503\"}\n\n### **The Study at a Glance**\n\nOur dataset included responses from individuals, detailing their income levels and their preferred living areas, ranging from the bustling city center to the tranquil rural landscapes. We introduced the \"relocating index\" to represent this preference spectrum. The approach was as follows:\n\n-   Transforming income into a continuous scale, assigning monetary values to income brackets.\n\n-   Converting living area preferences into a single, ordinal dependent variable 'Living Location Preference: *moving from urban to rural index*'.\n\n### Insights from Linear Regression Analysis\n\nEmploying linear regression to model the relationship between the two variables: income & Relocating index.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score\nimport matplotlib.pyplot as plt\n\n# Load the dataset\ndata = pd.read_excel('Income_LivingLocationPrefrences.xlsx')\n\n# Handle NaN values\ndata.dropna(subset=['City_center', 'Urban_area', 'Suburban_area', 'Rural_area', 'Monthly_income'], inplace=True)\n\n# Convert the Location preferences into a single ordinal dependent variable\narea_to_number = {'City_center': 1, 'Urban_area': 2, 'Suburban_area': 3, 'Rural_area': 4}\ndata['living_Location_preference'] = data[['City_center', 'Urban_area', 'Suburban_area', 'Rural_area']].idxmin(axis=1).map(area_to_number)\n\n# Convert income to a continuous scale based on the provided income brackets\nincome_mapping = {1.0: 625, 2.0: 2292, 3.0: 5000, 4.0: 6666}\ndata['continuous_income'] = data['Monthly_income'].map(income_mapping)\n\n# Scale the income feature\nscaler = StandardScaler()\ndata['scaled_income'] = scaler.fit_transform(data[['continuous_income']])\n\n# Prepare the features and target variable for modeling\nX = data[['scaled_income']]\ny = data['living_Location_preference']\n\n# Split the data into training and testing sets\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# Create and train the linear regression model\nmodel = LinearRegression()\nmodel.fit(X_train, y_train)\n\n# Predict on the test data\ny_pred = model.predict(X_test)\n\n# Evaluate the model's performance\nmse = mean_squared_error(y_test, y_pred)\nr2 = r2_score(y_test, y_pred)\n\n# Output the performance metrics\nprint(f'Mean Squared Error: {mse}')\nprint(f'R-squared: {r2}')\n\n# Debugging the sizes of arrays\nprint(\"Sizes of arrays for plotting:\")\nprint(\"X_test['scaled_income']: \", len(X_test['scaled_income']))\nprint(\"y_test: \", len(y_test))\nprint(\"y_pred: \", len(y_pred))\n\n# Plotting\nplt.scatter(X_test['scaled_income'].values, y_test.values, color='black', label='Actual Data')\nplt.scatter(X_test['scaled_income'].values, y_pred, color='red', label='Predicted Data', alpha=0.5)\n\n# Optionally, create a more continuous line for predictions\nsorted_order = np.argsort(X_test['scaled_income'].values)\nplt.plot(X_test['scaled_income'].values[sorted_order], y_pred[sorted_order], color='blue', linewidth=2, label='Regression Line')\n\nplt.xlabel('Monthly income')\nplt.ylabel('Living Location Preference:Relocating index_From urban to rural')\nplt.title('Income vs Living Location Preference Linear Regression')\nplt.legend()\nplt.show()\n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nMean Squared Error: 1.2658068009077692\nR-squared: 0.006851215790502296\nSizes of arrays for plotting:\nX_test['scaled_income']:  162\ny_test:  162\ny_pred:  162\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-2.png){width=589 height=449}\n:::\n:::\n\n\n### **Unveiling the Linear Regression Insights for WFH Workers**\n\nOur linear regression model yielded the following insights:\n\n-   **Mean Squared Error (MSE)**: The model showed an MSE of 1.2658068009077692. This number, though not extremely high, indicates some discrepancies between the model's predictions and the actual data.\n\n-   **R-squared Value**: We obtained an R-squared value of 0.006851215790502296. This low value suggests that our model might not be capturing the complete picture, especially in the context of WFH employees.\n\n#### Visualization of the Linear Regression Model\n\nA regression plot was used to illustrate our findings. The actual data points (black dots) showed significant deviation from the blue regression line (the model's predictions). The red dots, representing the model's predicted values, also varied widely from many actual data points, indicating a mismatch between the model's predictions and the real data.\n\n### Transitioning to Non-Linear Models\n\nThe visual and numerical analysis led us to consider that the relationship between income and living area preferences might not be linear. This prompted a shift towards exploring non-linear patterns.\n\n#### Implementing Ordinal Regression Model\n\n### **Why We Chose an Ordinal Regression Model**\n\nWe transitioned to an Ordinal Regression Model for these key reasons:\n\n1.  **Appropriate for Ordinal Data**: Our data on living location preferences is ordinal (ranging from city centers to rural areas). Ordinal regression accurately handles such data, unlike linear regression.\n\n2.  **Captures Non-Linear Patterns**: This model is better suited to reveal non-linear relationships between income and living location preferences, which our initial analysis suggested.\n\n3.  **Enhanced Predictive Accuracy**: Ordinal regression aligns more closely with our real-world data, potentially offering improved accuracy in predictions.\n\nIn essence, the Ordinal Regression Model provides a more appropriate and nuanced analysis for our study's specific data characteristics.\n\n### **Implementing ordinal regression model**\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nimport pandas as pd\nimport statsmodels.api as sm\nfrom sklearn.model_selection import train_test_split\n\n# Load the dataset\ndata = pd.read_excel('Income_LivingLocation_GradientBoostingRegressor.xlsx')  \n# Update the path to your file\n\n# Combine the area preferences into a single ordinal variable\ndef get_preference_rank(row):\n    if row['City_center'] == 1:\n        return 1\n    elif row['Urban_area'] == 1:\n        return 2\n    elif row['Suburban_area'] == 1:\n        return 3\n    elif row['Rural_area'] == 1:\n        return 4\n\ndata['living_area_preference'] = data.apply(get_preference_rank, axis=1)\n\n# Prepare the features and the target variable\nX = data[['Monthly_income', 'Education_Level', 'House_owner_or_renter', 'number of employees in household']]\ny = data['living_area_preference']\n\n# Add a constant to the model (intercept)\nX = sm.add_constant(X)\n\n# Split the data into training and testing sets\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# Fit the ordinal regression model\nmodel = sm.MNLogit(y_train, X_train)\nresult = model.fit()\n\n# Output the model summary\nprint(result.summary())\n\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOptimization terminated successfully.\n         Current function value: 1.336686\n         Iterations 5\n                            MNLogit Regression Results                            \n==================================================================================\nDep. Variable:     living_area_preference   No. Observations:                  680\nModel:                            MNLogit   Df Residuals:                      665\nMethod:                               MLE   Df Model:                           12\nDate:                    Mon, 27 Nov 2023   Pseudo R-squ.:                 0.03553\nTime:                            05:20:37   Log-Likelihood:                -908.95\nconverged:                           True   LL-Null:                       -942.43\nCovariance Type:                nonrobust   LLR p-value:                 1.174e-09\n====================================================================================================\n        living_area_preference=2       coef    std err          z      P>|z|      [0.025      0.975]\n----------------------------------------------------------------------------------------------------\nconst                                2.5322      0.630      4.020      0.000       1.298       3.767\nMonthly_income                      -0.6509      0.124     -5.230      0.000      -0.895      -0.407\nEducation_Level                      0.0909      0.055      1.642      0.101      -0.018       0.199\nHouse_owner_or_renter               -0.6254      0.262     -2.388      0.017      -1.139      -0.112\nnumber of employees in household    -0.2076      0.160     -1.296      0.195      -0.522       0.106\n----------------------------------------------------------------------------------------------------\n        living_area_preference=3       coef    std err          z      P>|z|      [0.025      0.975]\n----------------------------------------------------------------------------------------------------\nconst                                2.8972      0.633      4.575      0.000       1.656       4.138\nMonthly_income                      -0.7957      0.126     -6.294      0.000      -1.043      -0.548\nEducation_Level                      0.0914      0.056      1.626      0.104      -0.019       0.202\nHouse_owner_or_renter               -0.6095      0.264     -2.307      0.021      -1.127      -0.092\nnumber of employees in household    -0.2320      0.163     -1.426      0.154      -0.551       0.087\n----------------------------------------------------------------------------------------------------\n        living_area_preference=4       coef    std err          z      P>|z|      [0.025      0.975]\n----------------------------------------------------------------------------------------------------\nconst                                0.9399      0.628      1.496      0.135      -0.292       2.171\nMonthly_income                      -0.5330      0.124     -4.314      0.000      -0.775      -0.291\nEducation_Level                      0.1038      0.055      1.893      0.058      -0.004       0.211\nHouse_owner_or_renter               -0.0429      0.241     -0.178      0.859      -0.516       0.430\nnumber of employees in household     0.0543      0.160      0.341      0.733      -0.258       0.367\n====================================================================================================\n```\n:::\n:::\n\n\n### Our Multinomial Logistic Regression analysis revealed some interesting insights about the relationship between various factors and living area preferences:\n\n1.  **Model Convergence and Fit**: The model successfully converged after 5 iterations, indicating a reliable fit to the data. The Pseudo R-squared value of 0.03553, while modest, suggests that our model has some explanatory power, though other unaccounted factors might also play a significant role.\n\n2.  **Significant Predictors**:\n\n    -   **Monthly Income**: This was a significant predictor across all living area preferences (2, 3, and 4). The negative coefficients (-0.6509, -0.7957, and -0.5330) indicate that as monthly income increases, the likelihood of preferring urban (2) or suburban (3) areas over rural (4) areas decreases.\n\n    -   **House Ownership Status**: This variable also showed significance in influencing living area preference, with negative coefficients suggesting that those who own houses or are renters are less likely to prefer urban or suburban areas compared to rural ones.\n\n3.  **Other Factors**:\n\n    -   **Education Level**: While the coefficients were positive, suggesting a higher likelihood of preferring urban or suburban areas with increased education level, the significance was marginal.\n\n    -   **Number of Employees in Household**: This factor did not show a strong influence on living area preference, as indicated by the higher p-values.\n\n4.  **Coefficient Interpretation**: The coefficients for each predictor vary for different living area preferences, reflecting the complex nature of these relationships. For instance, the impact of monthly income is more pronounced in preferring suburban areas (living_area_preference=3) than in urban or rural areas.\n\nIn conclusion, our Multinomial Logistic Regression model sheds light on how factors like income and house ownership status significantly influence living area preferences among WFH workers. The nuanced differences in coefficients across different living areas underscore the complexity of these relationships.\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}